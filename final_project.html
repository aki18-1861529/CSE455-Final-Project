<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="styles.css">
    <title>CSE 455 Final Project</title>
  </head>
  <body>
    <header id="title">
      <div>
        <h1>Face Detection and Recognition</h1>
        <p>CSE 455 Spring 2022</p>
        <p>Duke Parks, Amanda Ki, Priti Ahya, Abas Hersi, Michael Wen, Edison Chau</p>
      </div>
    </header>

    <hr>

    <section>
        <h1>Introduction</h1>
        <hr>
        <p>
            Facial recognition is a technology that has been around for decades. During this time, the
            technology has matured, and saw many different applications in various fields, ranging from
            live camera filters to security. Despite the range of applications it has, facial recognition
            boils down to software that can detect a person's face in visual media, such as photos and videos.
        </p>
        <p>
            However, like with many other technologies, the way facial recognition is implemented varies
            between developers, and therefore can have some variation in terms of accuracy and performance.
        </p>
        <p>
            Based on this idea, we decided to implement a facial recognition software that builds on two different
            facial recognition techniques in order to compare their performance:
            <ol>
                <li>
                    The first technique uses a Facebook technology called DETR (DEtection TRansformer),
                    which is used to detect and recognize different subject models, which we modified for
                    recognizing faces.
                </li>
                <li>
                    The second technique uses Principal Component Analysis (PCA) and data from the Yale Face
                    Database to detect faces based on a generated "average" face.
                </li>
            </ol>
        </p>
    </section>

    <section>
        <h1>Problem Setup</h1>
        <hr>
        <p>
            The problem our project aimed to solve was how we can improve facial detection technologies.
            Facial recognition has a multitude of different applications within various fields such as security,
            education, healthcare, etc. While facial recognition models aren’t novel, previous iterations often
            use complicated objection detection pipelines, which are often difficult to make and hinder
            the speed and efficiency at which models are generated.
        </p>
    </section>

    <section>
        <h1>Pre-existing Work</h1>
        <hr>
        <p>Some pre-existing work and/or resources that we used in this project include:</p>
        <ol>
            <li>DETR Implementation</li>
            <li>Code to convert WiderFaces to COCO format</li>
            <li>Eigenfaces (implemented from scratch for this project, but by no means a new technique)</li>
            <li>Matrix of cropped and vectorized images from Yale Face Database B</li>
        </ol>
    </section>

    <section>
        <h1>Techniques</h1>
        <hr>
        <img src="image1.png" alt="how DETR works" />
        <p>Model used: DETR</p>
        <p>Loss function:</p>
        <p>
            We used the existing DETR network pretrained on COCO dataset with a ResNet50 backbone and retrained it on the
            WiderFaces dataset, so it would detect faces rather than objects. Then, we gave it images of celebrities collected
            from the internet. DETR is able to detect multiple faces in an image. Since DETR outputs bounding boxes for each face
            detected in an image, we used the bounding boxes to crop and save each face found. The cropped celebrity faces
            output from DETR were then used as input images for PCA.  We chose to use DETR over the many possible network/
            algorithms that can do face detection for its novelty.  DETR is among the firsts detection/classification networks
            to incorporate a transformer into its architecture.  The use of transformers for such tasks is an exciting new
            frontier in computer vision that has thus far shown great results.  As an example of this, DINO, a refinement of
            DETR, is ranked #1 on Object Detection on COCO test-dev and COCO minival on PapersWithCode.com.
        </p>
        <p>
            For facial recognition, we chose to use PCA/Eigenfaces.  The greatest advantage of PCA is that it requires far fewer
            data and compute resources to produce fairly accurate results.  In implementing this project, we created a PCA model
            from scratch to analyze the human face using faces from the Yale Face Database B. The input images of celebrities
            from DETR are first grayscale and resized to the same width and length. The resized images are then used to find
            their “average” face for classification. PCA is performed on each input image. To classify an image, the result of
            each input image is compared with the results of the average faces.  The intuition of this can be seen in the graph
            below that shows 8th, 9th, and 10th principal components of test images and average faces.
        </p>
        <img src="image2.gif" alt="principal components gif" />
        <p>
            Even though this is a lower dimensional image, you can still see some clustering occurring.
            We can expect a greater degree of clustering to be present in the full 800-dimensional space.
        </p>
    </section>

    <section>
        <h1>Datasets</h1>
        <hr>
        <ol>
            <li><a href="http://shuoyang1213.me/WIDERFACE/">WiderFaces data</a></li>
            <li><a href="http://www.databookuw.com/page-17/">Yale Face Database B</a></li>
            <li>About 80 self-collected images of celebrities</li>
        </ol>
    </section>

    <section>
        <h1>Results</h1>
        <hr>
        <p>
            Based on the data we collected, we found that DETR has better performance than PCA does. However, this performance
            comes with a tradeoff. DETR relies on a very large amount of data that takes a very long time and a lot of resources
            to properly train and run, and requires data to be tailored beforehand. On the other hand, PCA is much less demanding
            in terms of data and resources, and is more flexible with the data it is given, at the cost of less accuracy.
        </p>
    </section>

    <section>
        <h1>Alternative Approaches</h1>
        <hr>
        <p>
            As one could imagine, there are a number of different approaches to both face detection and face recognition.
            Just a few examples are listed below:
        </p>
        <ol>
            <li>Face Detection:</li>
            <ol>
                <li>Haar Cascade Classifier</li>
                <li>R-CNNs</li>
            </ol>
            <li>Eigenface: Performs feature analysis on a collection of facial images and forms a set of basic features.</li>
            <li>
                Traditional Facial Recognition Models: traditional facial recognition models which typically use complicated objection detection pipelines and slower R-CNNs
            </li>
        </ol>
        <p>
            The greatest advantage of PCA is that it requires far fewer data and compute resources to produce fairly accurate results.
        </p>
    </section>

    <section>
        <h1>Challenges and Potential Improvements</h1>
        <hr>
        <p>
            Our initial project goal was to design software that allowed users to superimpose clothing designs onto images of
            models to allow users to simulate what the clothing would look like without the need of a physical model. However,
            due to constraints such as a lack of time and unfamiliarity with certain resources, such as how we would have needed
            Blender for the project, a program none of our group members have experience with, we decided to shift our project
            topic to the current facial recognition focus.
        </p>
        <p>
            Most of the challenges we faced over the course of the project involved figuring out how to integrate the
            pre-existing technologies we chose into the project. DETR was especially difficult to incorporate as we had trouble
            figuring out how it was structured in order to give it a proper input and interpret the output correctly.
            Additionally, DETR is very resource-demanding and required a GPU that no one in our group had.  This resulted in our
            group having to split our project: half of it on Colab, half of it on Github.
        </p>
        <p>
            If given more time on the project, we would like to explore and incorporate other publicly-available facial
            recognition technologies and see how they compare with each other, and to see if we can determine a “sweet spot” of
            sorts that balances resource usage and accuracy.  We also would like to create a more quantitative comparison of
            different techniques for both face detection and face recognition.  Such a comparison could be the differences in
            accuracy and compute time of DETR versus Haar Cascade Classifiers.
        </p>
    </section>

    <section>
        <h1>References</h1>
        <p>
            <a href="https://github.com/facebookresearch/detr">DETR</a>
        </p>
    </section>
  </body>
</html>
